using FRED.Core.Data;
using FRED.Core.Events;
using FRED.Core.Interfaces;
using Newtonsoft.Json;
using System;
using System.Collections.Generic;
using System.IO;
using System.Text;
using System.Text.RegularExpressions;

namespace FRED.Core.Parser {
    public class ExportFile : Consumable {
        private List<Action> on_ready                            = new List<Action>();
        private Dictionary<String, FileContainer?> files         = new Dictionary<String, FileContainer?>();
        private Dictionary<String, FileDefinition?> definitions  = new Dictionary<String, FileDefinition?>();
        private String? file             = null;
        private String? content          = null;
        private String? name             = null;
        private String? checksum         = null;
        private Boolean is_ready         = false;
        private PropertyList? properties;
        public event EventHandler? observer;

        public ExportFile(String? file) {
            this.file = file;

            this.LoadDefinitions();
        }

        private void LoadDefinitions() {
           String content               = File.ReadAllText("./Definitions/Files.json", Encoding.UTF8);
            List<FileDefinition?>? json = JsonConvert.DeserializeObject<List<FileDefinition?>?>(content);
            
            if(json != null) {
                json.ForEach(file => {
                    if(file  != null && file.File != null) { 
                        definitions.Add(file.File, file);
                    }
                });
            }
        }

        public FileDefinition? GetDefinition(String? name) {
            if(this.definitions == null || name == null) {
                return null;
            }

            return this.definitions.GetValueOrDefault(name, null);
        }

        public void SetObserver(Changeable? instance) {
            if(instance == null) {
                return;
            }

            observer += instance.OnChange;
        }

        public Boolean IsReady() {
            return this.is_ready;
        }

        public void OnReady(Action callback) {
            this.on_ready.Add(callback);
        }

        public bool Get(String name, Action<object?> callback) {
            if(!this.is_ready) {
                return false;
            }

            System.Diagnostics.Debug.Print("[REQUEST] " + name);

            switch (name) {
                case "Info":
                    DateTime time_changed = new DateTime();
                    DateTime time_created = new DateTime();

                    if(this.file != null) {
                        time_changed = File.GetLastWriteTime(this.file);
                        time_created = File.GetCreationTime(this.file);
                    }

                    callback.Invoke((object) new InfoData () {
                        Name        = this.name,
                        File        = this.file,
                        Checksum    = this.checksum,
                        TimeChanged = time_changed,
                        TimeCreated = time_created,
                        Files       = this.files.Count
                    });
                break;
                case "Name":
                    callback.Invoke(this.name);
                break;
                case "File":
                    callback.Invoke(this.file);
                break;
                case "Checksum":
                    callback.Invoke(this.checksum);
                break;
                case "Properties":
                    callback.Invoke( this.properties);
                break;
                default:
                    if(files.ContainsKey(name)) {
                        callback.Invoke(files[name]);
                    } else {
                        callback.Invoke(null);
                    }
                break;
            }

            return true;
        }

        public PropertyList? GetProperties() {
            return this.properties;
        }

        public void Parse() {
            if(this.file == null) {
                System.Diagnostics.Debug.Print("File is empty?");
                return;
            }

            this.content = File.ReadAllText(this.file, Encoding.UTF8);

            Regex export    = new Regex(@"^\*{4}\s(?<name>[A-Za-z!\s0-9]+)?\sCONFIGURATION\sEXPORT\s(?<content>[\s\S]*?)?\*{4}\sEND\sOF\sEXPORT\s(?<checksum>[A-F0-9]+)?\s\*{4}\s*?$", RegexOptions.IgnoreCase | RegexOptions.Multiline);
            Match match     = export.Match(this.content);

            if(!match.Success) {
                System.Diagnostics.Debug.Print("No Matches Found, bad export file?");
                return;
            }
           
            this.name       = match.Groups["name"].Value;
            this.checksum   = match.Groups["checksum"].Value;
            this.content    = match.Groups["content"].Value;

            // Get Properties
            Regex properties    = new Regex(@"^\A(?<properties>[\s\S]*?)\s(\*{4})", RegexOptions.IgnoreCase | RegexOptions.Multiline);
            match               = properties.Match(this.content);
            String props        = match.Groups["properties"].Value;
            this.content        = this.content.Replace(props, "");
            this.properties     = new PropertyList(props);

            observer?.Invoke(this, new PropertiesEvent(this.properties));

            this.ParseFiles();

            this.is_ready = true;

            foreach(Action callback in this.on_ready) {
                callback();
            }
        }

        public void ParseFiles() {
            Regex files = new Regex(@"^\*{4}\s(?:CRYPTED)?(?<type>(CFG|BIN|B64))?FILE:(?<name>.*)?\s(?<content>[\s\S]*?)?\s\*{4}\sEND\sOF\sFILE\s\*{4}\s*?$", RegexOptions.IgnoreCase | RegexOptions.Multiline);

            if(this.content != null) {
                foreach (Match match in files.Matches(this.content)) {
                    FileContainer file = new FileContainer(match.Groups["name"].Value, match.Groups["type"].Value);

                    if(file != null) {
                        String? name                = file.GetName();
                        FileDefinition? definition  = this.GetDefinition(name);

                        if(!match.Groups["crypted"].Value.Equals("")) {
                            file.SetCrypted();
                        }

                        if(definition != null) {
                            file.SetDefinition(ref definition);
                        }

                        file.SetContent(match.Groups["content"].Value);

                        // @ToDo Parse Content
                        SectionsParser sec = new SectionsParser();
                        sec.Parse("/*\r\n * /var/tmp.cfg\r\n * Sun Oct 15 12:53:05 2023\r\n */\r\n\r\nmeta { encoding = \"utf-8\"; }\r\n\r\nar7cfg {\r\n        mode = dsldmode_router;\r\n        active_provider = \"other\";\r\n        active_name = \"\";\r\n        igddenabled = yes;\r\n        wan_bridge_with_dhcpc = yes;\r\n        wan_bridge_gateway = 0.0.0.0;\r\n        dhcpc_use_static_dns = no;\r\n        dhcp_dslforumorg = yes;\r\n        ethmode = ethmode_bridge;\r\n        tcom_targetarch = no;\r\n        vdsl_resalearch = no;\r\n        aontv_arch = no;\r\n        bng_arch = yes;\r\n        hsi_use_wan_vlan = yes;\r\n        hsi_vlancfg {\r\n                vlanencap = vlanencap_none;\r\n                tagtype = vlantagtype_customer;\r\n                vlanid = 0;\r\n                vlanprio = 0;\r\n                tos = 0;\r\n        }\r\n        mtu_cutback_mode = mtumode_auto;\r\n        mtu_cutback = 1500;\r\n        StatisticStartOfMonth = 1;\r\n        enable_mac_override = yes;\r\n        macdsl_override = 00:00:00:00:00:00;\r\n        ipv6mode = ipv6_native;\r\n        ipv4mode = ipv4_ds_lite_only;\r\n        enable_snmp_on_wan = yes;\r\n        enable_tr069_on_wan = no;\r\n        erouter_enabled = yes;\r\n        emta_enabled = yes;\r\n        emta_stackmode = stackmode_ipv4only;\r\n        emta_ignore_oem = yes;\r\n        emta_enable_tr069 = yes;\r\n        emta_fakepacm = yes;\r\n        edva_enabled = no;\r\n        edocsis_pppoe = no;\r\n        lanport1_not_in_bridge = no;\r\n        serialcfg {\r\n                mode = serialmode_off;\r\n                mbim = mbimmode_off;\r\n                number = \"*99#\";\r\n                provider = \"internet.t-mobile\";\r\n                username = \"$$$$VNUO3TJ46UI51JB1OOWYJ1XZEU1IKHESV41GHNLJMT4RX4EHUIY2R1GFEBZWMKBNSXWAI2GGWIQY2ACB\";\r\n                passwd = \"$$$$NOJO5VLT15FP6T55DP3PGB4A5J6KDUJSUV54SOVHAPXJ2LCUWAEULIRFZ2GRGTVPDRMHD3IJSZI4PACB\";\r\n                connect_chatscript = \"ABORT BUSY ABORT 'NO CARRIER'\",\r\n                                     \"ABORT VOICE ABORT 'NO DAILTONE'\",\r\n                                     \"ABORT 'NO ANSWER' ABORT DELAYED\",\r\n                                     \"ABORT ERROR\", \"TIMEOUT 20\",\r\n                                     \"'' 'AT+cgdcont=1,\\\\\"IP\\\\\",\\\\\"${provider}\\\\\"'\",\r\n                                     \"OK 'ATDT${number}'\", \"CONNECT\",\r\n                                     \"WAIT 2\";\r\n                stay_always_online = no;\r\n                inactivity_timeout = 1m;\r\n                backup {\r\n                        enabled = no;\r\n                        quickstart = serialquickstart_off;\r\n                        downtime = 3m;\r\n                        reverttime = 30m;\r\n                }\r\n        }\r\n        ethinterfaces {\r\n                name = \"nsgmii1\";\r\n                dhcp = no;\r\n                ipaddr = 192.168.178.1;\r\n                netmask = 255.255.255.0;\r\n                dstipaddr = 0.0.0.0;\r\n                dhcpenabled = yes;\r\n                dhcpstart = 0.0.0.0;\r\n                dhcpend = 0.0.0.0;\r\n                is_guest = no;\r\n                is_hotspot = no;\r\n                multicast_snooping = yes;\r\n                is_public = no;\r\n        } {\r\n                name = \"wlan\";\r\n                dhcp = no;\r\n                ipaddr = 192.168.182.1;\r\n                netmask = 255.255.255.0;\r\n                dstipaddr = 0.0.0.0;\r\n                interfaces = \"ath?\", \"vap?\", \"wdsup?\";\r\n                dhcpenabled = yes;\r\n                dhcpstart = 0.0.0.0;\r\n                dhcpend = 0.0.0.0;\r\n                is_guest = no;\r\n                is_hotspot = no;\r\n                multicast_snooping = yes;\r\n                is_public = no;\r\n        }\r\n        brinterfaces {\r\n                name = \"lan\";\r\n                dhcp = no;\r\n                ipaddr = 192.168.178.1;\r\n                netmask = 255.255.255.0;\r\n                dstipaddr = 0.0.0.0;\r\n                interfaces = \"eth0\", \"eth1\", \"eth2\", \"eth3\", \"ath?\", \"vap?\",\r\n                             \"nsgmii0\", \"wdsup?*\";\r\n                dhcpenabled = yes;\r\n                dhcpstart = 0.0.0.0;\r\n                dhcpend = 0.0.0.0;\r\n                is_guest = no;\r\n                is_hotspot = no;\r\n                multicast_snooping = yes;\r\n                is_public = no;\r\n        } {\r\n                name = \"lan:0\";\r\n                dhcp = no;\r\n                ipaddr = 169.254.1.1;\r\n                netmask = 255.255.0.0;\r\n                dstipaddr = 0.0.0.0;\r\n                dhcpenabled = yes;\r\n                dhcpstart = 0.0.0.0;\r\n                dhcpend = 0.0.0.0;\r\n                is_guest = no;\r\n                is_hotspot = no;\r\n                multicast_snooping = yes;\r\n                is_public = no;\r\n        } {\r\n                name = \"guest\";\r\n                dhcp = no;\r\n                ipaddr = 192.168.179.1;\r\n                netmask = 255.255.255.0;\r\n                dstipaddr = 0.0.0.0;\r\n                interfaces = \"guest?*\", \"guest_ct*\", \"guest_st*\";\r\n                dhcpenabled = yes;\r\n                dhcpstart = 0.0.0.0;\r\n                dhcpend = 0.0.0.0;\r\n                is_guest = yes;\r\n                is_hotspot = no;\r\n                multicast_snooping = yes;\r\n                is_public = no;\r\n        }\r\n        dslinterface {\r\n                name = \"dsl\";\r\n                dhcp = no;\r\n                ipaddr = 0.0.0.0;\r\n                netmask = 0.0.0.0;\r\n                dstipaddr = 0.0.0.0;\r\n                dhcpenabled = yes;\r\n                dhcpstart = 0.0.0.0;\r\n                dhcpend = 0.0.0.0;\r\n                is_guest = no;\r\n                is_hotspot = no;\r\n                multicast_snooping = yes;\r\n                is_public = no;\r\n        }\r\n        dslinterface_metric = 2;\r\n        ipbridge {\r\n                enabled = no;\r\n        }\r\n        pppoefw {\r\n                interfaces = \"lan\", \"eth0\", \"eth1\", \"eth2\", \"eth3\",\r\n                             \"nsgmii0\", \"usbrndis\", \"wlan\";\r\n                nofirewall = yes;\r\n                dnsfilter_for_active_directory = yes;\r\n                hostuniq_filter = \"\";\r\n                dpconfig {\r\n                        security = dpsec_host;\r\n                        filter_teredo = yes;\r\n                        filter_netbios = yes;\r\n                        filter_sip = no;\r\n                        filter_smtp = no;\r\n                        sip_alg = no;\r\n                        lowinput {\r\n                                policy = \"reject\";\r\n                                accesslist =\r\n                                             \"permit ip any any connection outgoing-related\",\r\n                                             \"permit ip any any connection incoming-related\",\r\n                                             \"permit icmp any any\";\r\n                        }\r\n                        lowoutput {\r\n                                policy = \"permit\";\r\n                        }\r\n                        highinput {\r\n                                policy = \"permit\";\r\n                        }\r\n                        highoutput {\r\n                                policy = \"permit\";\r\n                                accesslist =\r\n                                             \"reject ip any 242.0.0.0 255.0.0.0\",\r\n                                             \"deny ip any host 255.255.255.255\",\r\n                                             \"reject ip any 169.254.0.0 255.255.0.0\";\r\n                        }\r\n                }\r\n                inherit_vlan_from_internet = yes;\r\n        }\r\n        budget {\r\n                Enabled = no;\r\n                Period = 2;\r\n                VolumeLow = 0;\r\n                VolumeHigh = 0;\r\n                ConnectionTime = 0;\r\n                WarnOnly = yes;\r\n        }\r\n        sync_groups {\r\n                name = \"sync_cable\";\r\n                enabled = yes;\r\n                media_type = media_type_cable;\r\n                connect_delay_when_synced = 3s;\r\n                pppoeiface_link_mode = link_mode_unknown;\r\n                speed_in_netto = 1024;\r\n                speed_out_netto = 512;\r\n                manual_speed = no;\r\n                autoconfig = yes;\r\n        } {\r\n                name = \"sync_ata\";\r\n                enabled = no;\r\n                media_type = media_type_ata;\r\n                connect_delay_when_synced = 3s;\r\n                pppoeiface_link_mode = link_mode_unknown;\r\n                pppoeiface = \"nsgmii0\";\r\n                speed_in_netto = 1024;\r\n                speed_out_netto = 512;\r\n                manual_speed = no;\r\n                autoconfig = yes;\r\n        } {\r\n                name = \"sync_wlan_ata\";\r\n                enabled = no;\r\n                media_type = media_type_wlan_ata;\r\n                connect_delay_when_synced = 3s;\r\n                pppoeiface_link_mode = link_mode_unknown;\r\n                speed_in_netto = 1024;\r\n                speed_out_netto = 512;\r\n                manual_speed = no;\r\n                autoconfig = yes;\r\n        } {\r\n                name = \"sync_serial\";\r\n                enabled = no;\r\n                media_type = media_type_serial;\r\n                connect_delay_when_synced = 3s;\r\n                pppoeiface_link_mode = link_mode_unknown;\r\n                speed_in_netto = 1024;\r\n                speed_out_netto = 512;\r\n                manual_speed = no;\r\n                autoconfig = yes;\r\n        } {\r\n                name = \"sync_lte\";\r\n                enabled = no;\r\n                media_type = media_type_lte;\r\n                connect_delay_when_synced = 3s;\r\n                pppoeiface_link_mode = link_mode_unknown;\r\n                speed_in_netto = 1024;\r\n                speed_out_netto = 512;\r\n                manual_speed = no;\r\n                autoconfig = yes;\r\n        } {\r\n                name = \"sync_ipclient\";\r\n                enabled = no;\r\n                media_type = media_type_ipclient;\r\n                connect_delay_when_synced = 3s;\r\n                pppoeiface_link_mode = link_mode_unknown;\r\n                pppoeiface = \"lan\";\r\n                speed_in_netto = 1024;\r\n                speed_out_netto = 512;\r\n                manual_speed = no;\r\n                autoconfig = yes;\r\n        }\r\n        vccs {\r\n                VPI = 1;\r\n                VCI = 32;\r\n                traffic_class = atm_traffic_class_UBR;\r\n                pcr = 0;\r\n                scr = 0;\r\n                priority = 0;\r\n                ifname = \"erouter0\";\r\n                dsl_encap = dslencap_mixed;\r\n                ipbridgeing = no;\r\n                ipbridgeing_igmp = no;\r\n                pppoeforwarding = no;\r\n                connections = \"internet\", \"voip\";\r\n                sync_group = \"sync_cable\";\r\n        } {\r\n                VPI = 1;\r\n                VCI = 32;\r\n                traffic_class = atm_traffic_class_UBR;\r\n                pcr = 0;\r\n                scr = 0;\r\n                priority = 0;\r\n                dsl_encap = dslencap_mixed;\r\n                ipbridgeing = no;\r\n                ipbridgeing_igmp = no;\r\n                pppoeforwarding = no;\r\n                connections = \"internet\";\r\n        }\r\n        mcupstream = \"internet\";\r\n        voip_forwardrules = \"udp 0.0.0.0:5060 0.0.0.0:5060\",\r\n                            \"tcp 0.0.0.0:5060 0.0.0.0:5060\",\r\n                            \"udp 0.0.0.0:7078+20 0.0.0.0:7078\";\r\n        voip_ip6_forwardrules = \"udp 5060 # SIP\", \"tcp 5060 # SIP\",\r\n                                \"udp 7078-7097 # RTP\";\r\n        tr069_forwardrules = \"tcp 0.0.0.0:8089 0.0.0.0:8089\";\r\n        tr069_ip6_forwardrules = \"tcp 8089\";\r\n        internet_in_nat_rules_enabled = yes;\r\n        internet_out_nat_rules_enabled = yes;\r\n        dslifaces {\r\n                enabled = yes;\r\n                name = \"internet\";\r\n                weight = 50;\r\n                dsl_encap = dslencap_ether;\r\n                dslinterfacename = \"dsl\";\r\n                no_masquerading = no;\r\n                use_fixed_masqaddr_if_no_masquerading = no;\r\n                no_firewall = no;\r\n                stackmode = stackmode_ipv4only;\r\n                pppoevlanauto = no;\r\n                pppoevlanauto_startwithvlan = no;\r\n                ppptarget = \"internet\";\r\n                rfc4638_enabled = no;\r\n                fixed_masqaddr = 0.0.0.0;\r\n                mtu = 0;\r\n                gre_server_cfg {\r\n                        server_dnsprefer = protoprefer_ipv4;\r\n                        dpd {\r\n                                inactivity = 20s;\r\n                                replywait = 1s;\r\n                                npings = 4;\r\n                                period = 30s;\r\n                        }\r\n                        allow_netbios = no;\r\n                }\r\n                etherencapcfg {\r\n                        use_dhcp = yes;\r\n                        use_dhcp_if_not_encap_ether = no;\r\n                        ipaddr = 0.0.0.0;\r\n                        netmask = 0.0.0.0;\r\n                        gateway = 0.0.0.0;\r\n                        dns1 = 0.0.0.0;\r\n                        dns2 = 0.0.0.0;\r\n                }\r\n                is_mcupstream = yes;\r\n                stay_always_online = no;\r\n                disable_ondemand = no;\r\n                reconnect_delay_after_conn_abort = 30s;\r\n                reconnect_delay_after_disconnect = 0w;\r\n                only_route_when_connected = no;\r\n                redial_delay_after_auth_failure = 1m;\r\n                redial_limit = 20;\r\n                redial_after_limit_reached = 10m;\r\n                redial_after_limit_reached_variance = 5m;\r\n                redial_after_limit_randomize = no;\r\n                redial_delay_after_low_error = 10s;\r\n                redial_delay_after_ppp_timeout = 10s;\r\n                redial_delay_after_ppp_error = 1m;\r\n                routes_only_for_local = no;\r\n                dproutes_only_for_local = no;\r\n                hide_interface_address = no;\r\n                disable_staticroutes_on_dhcproutes = no;\r\n                ripv2receiver_enabled = no;\r\n                ripv2_update_timer = 30s;\r\n                ripv2authmode = ripv2_auth_none;\r\n                ripv2md5_keyid = 0;\r\n                ripv2passwd = \"\";\r\n                set_replicate_dhcpoptions_in_parameter_request_list = no;\r\n                unset_ignored_dhcpoptions_in_parameter_request_list = yes;\r\n                dsldpconfig {\r\n                        security = dpsec_firewall;\r\n                        filter_teredo = yes;\r\n                        filter_netbios = yes;\r\n                        filter_sip = no;\r\n                        filter_smtp = no;\r\n                        sip_alg = no;\r\n                        lowinput {\r\n                                policy = \"permit\";\r\n                                accesslist =\r\n                                             \"deny ip any 242.0.0.0 255.0.0.0\",\r\n                                             \"deny ip any host 255.255.255.255\";\r\n                        }\r\n                        lowoutput {\r\n                                policy = \"permit\";\r\n                        }\r\n                        highinput {\r\n                                policy = \"permit\";\r\n                        }\r\n                        highoutput {\r\n                                policy = \"permit\";\r\n                                accesslist =\r\n                                             \"reject ip any 242.0.0.0 255.0.0.0\",\r\n                                             \"deny ip any host 255.255.255.255\",\r\n                                             \"reject ip any 169.254.0.0 255.255.0.0\";\r\n                        }\r\n                }\r\n                dhcp_auth_mode = auth_none;\r\n                dhcp_requests_with_client_id = yes;\r\n                dhcp_ignore_options_in_renewing = no;\r\n                is_erouter = no;\r\n                fakepacm = no;\r\n                dhcp_tr069_add_device_vendor_options = no;\r\n                use_random_macaddr = no;\r\n                arp_reply_for_any_net_enabled = yes;\r\n                use_random_ifaceid = no;\r\n                onlinecheck {\r\n                        offlinemode = onlinecheck_offlinemode_never;\r\n                        checkmode = onlinecheck_checkmode_dpd;\r\n                        check_delay = 5s;\r\n                        check_interval = 1m;\r\n                        disconnect_when_offline = no;\r\n                        timeoutbase = 5s;\r\n                        nretry = 4;\r\n                        fallback_lifetime = 1h;\r\n                }\r\n        } {\r\n                enabled = yes;\r\n                name = \"voip\";\r\n                weight = 50;\r\n                dsl_encap = dslencap_ether;\r\n                dslinterfacename = \"dsl\";\r\n                no_masquerading = no;\r\n                use_fixed_masqaddr_if_no_masquerading = no;\r\n                no_firewall = no;\r\n                stackmode = stackmode_ipv4only;\r\n                pppoevlanauto = no;\r\n                pppoevlanauto_startwithvlan = no;\r\n                ppptarget = \"voip\";\r\n                rfc4638_enabled = no;\r\n                fixed_masqaddr = 0.0.0.0;\r\n                mtu = 0;\r\n                gre_server_cfg {\r\n                        server_dnsprefer = protoprefer_ipv4;\r\n                        dpd {\r\n                                inactivity = 20s;\r\n                                replywait = 1s;\r\n                                npings = 4;\r\n                                period = 30s;\r\n                        }\r\n                        allow_netbios = no;\r\n                }\r\n                etherencapcfg {\r\n                        use_dhcp = yes;\r\n                        use_dhcp_if_not_encap_ether = no;\r\n                        ipaddr = 0.0.0.0;\r\n                        netmask = 0.0.0.0;\r\n                        gateway = 0.0.0.0;\r\n                        dns1 = 0.0.0.0;\r\n                        dns2 = 0.0.0.0;\r\n                        class_identifier = \"voip_unity-1919\";\r\n                }\r\n                is_mcupstream = no;\r\n                stay_always_online = no;\r\n                disable_ondemand = no;\r\n                reconnect_delay_after_conn_abort = 30s;\r\n                reconnect_delay_after_disconnect = 0w;\r\n                only_route_when_connected = no;\r\n                redial_delay_after_auth_failure = 1m;\r\n                redial_limit = 20;\r\n                redial_after_limit_reached = 10m;\r\n                redial_after_limit_reached_variance = 5m;\r\n                redial_after_limit_randomize = no;\r\n                redial_delay_after_low_error = 10s;\r\n                redial_delay_after_ppp_timeout = 10s;\r\n                redial_delay_after_ppp_error = 1m;\r\n                routes_only_for_local = no;\r\n                dproutes_only_for_local = no;\r\n                hide_interface_address = no;\r\n                disable_staticroutes_on_dhcproutes = no;\r\n                ripv2receiver_enabled = no;\r\n                ripv2_update_timer = 30s;\r\n                ripv2authmode = ripv2_auth_none;\r\n                ripv2md5_keyid = 0;\r\n                ripv2passwd = \"\";\r\n                set_replicate_dhcpoptions_in_parameter_request_list = no;\r\n                unset_ignored_dhcpoptions_in_parameter_request_list = yes;\r\n                dsldpconfig {\r\n                        security = dpsec_firewall;\r\n                        filter_teredo = yes;\r\n                        filter_netbios = yes;\r\n                        filter_sip = no;\r\n                        filter_smtp = no;\r\n                        sip_alg = no;\r\n                        lowinput {\r\n                                policy = \"permit\";\r\n                        }\r\n                        lowoutput {\r\n                                policy = \"permit\";\r\n                        }\r\n                        highinput {\r\n                                policy = \"permit\";\r\n                        }\r\n                        highoutput {\r\n                                policy = \"permit\";\r\n                        }\r\n                }\r\n                dhcp_auth_mode = auth_none;\r\n                dhcp_requests_with_client_id = yes;\r\n                dhcp_ignore_options_in_renewing = no;\r\n                is_erouter = no;\r\n                fakepacm = no;\r\n                dhcp_tr069_add_device_vendor_options = no;\r\n                use_random_macaddr = no;\r\n                arp_reply_for_any_net_enabled = yes;\r\n                use_random_ifaceid = no;\r\n                onlinecheck {\r\n                        offlinemode = onlinecheck_offlinemode_never;\r\n                        checkmode = onlinecheck_checkmode_dpd;\r\n                        check_delay = 5s;\r\n                        check_interval = 1m;\r\n                        disconnect_when_offline = no;\r\n                        timeoutbase = 5s;\r\n                        nretry = 4;\r\n                        fallback_lifetime = 1h;\r\n                }\r\n        }\r\n        targets {\r\n                type = pppcfg_target_internet;\r\n                name = \"internet\";\r\n                only_crypt_auth = no;\r\n                local {\r\n                        username = \"\";\r\n                        passwd = \"\";\r\n                }\r\n                remoteauth = pppcfg_authtype_chap;\r\n                remoteauth_only_on_incoming = yes;\r\n                remote {\r\n                }\r\n                inactivity_timeout = 5m;\r\n                bUseChargeInterval = no;\r\n                nChargeInterval = 1m;\r\n                lcpecho_disconnect_mode = lcpecho_auto;\r\n                logicaldisconnect_with_physical = yes;\r\n                disconnect_timeout = 0w;\r\n                finaldisconnectcall = no;\r\n                ipnetbiosspoofing = no;\r\n                dnsfilter_for_active_directory = no;\r\n                no_outgoing_calls = no;\r\n                coso = pppcfg_coso_caller;\r\n                callback_delay = 1s;\r\n                icbmode = pppcfg_icbmode_none;\r\n                ocbmode = pppcfg_ocbmode_none;\r\n                mscbprefered = no;\r\n                multilink {\r\n                        extra_static_channels = 0;\r\n                        max_channels = 1;\r\n                        automatic = no;\r\n                        automatic_param {\r\n                                window = 20s;\r\n                                add_percent = 85;\r\n                                drop_percent = 70;\r\n                                sportlich = no;\r\n                        }\r\n                }\r\n                header_compression = yes;\r\n                data_compression = pppcfg_datacomp_auto;\r\n                stac_reset_with_history_number = no;\r\n                encryption = pppcfg_crypt_none;\r\n                inactivity_prevention_interval = 0w;\r\n                new_ipaddr_on_connect = no;\r\n                my_ipaddr = 0.0.0.0;\r\n                his_ipaddr = 0.0.0.0;\r\n                overwrite_dns1 = 0.0.0.0;\r\n                overwrite_dns2 = 0.0.0.0;\r\n                bVolumeRoundUp = no;\r\n                VolumeRoundUpBytes = 0;\r\n                bProviderDisconnectPrevention = yes;\r\n                ProviderDisconnectPreventionInterval = 1d;\r\n                ProviderDisconnectPreventionHour = 1;\r\n                bProviderDisconnectPreventionHourSet = yes;\r\n                passiv_on_outgoing = no;\r\n                mode6 = mode6_off;\r\n                mode4 = mode4_normal;\r\n        } {\r\n                type = pppcfg_target_internet;\r\n                name = \"voip\";\r\n                only_crypt_auth = no;\r\n                local {\r\n                        username = \"\";\r\n                        passwd = \"\";\r\n                }\r\n                remoteauth = pppcfg_authtype_none;\r\n                remoteauth_only_on_incoming = yes;\r\n                remote {\r\n                }\r\n                inactivity_timeout = 0w;\r\n                bUseChargeInterval = no;\r\n                nChargeInterval = 1m;\r\n                lcpecho_disconnect_mode = lcpecho_auto;\r\n                logicaldisconnect_with_physical = yes;\r\n                disconnect_timeout = 0w;\r\n                finaldisconnectcall = no;\r\n                ipnetbiosspoofing = no;\r\n                dnsfilter_for_active_directory = no;\r\n                no_outgoing_calls = no;\r\n                coso = pppcfg_coso_caller;\r\n                callback_delay = 1s;\r\n                icbmode = pppcfg_icbmode_none;\r\n                ocbmode = pppcfg_ocbmode_none;\r\n                mscbprefered = no;\r\n                multilink {\r\n                        extra_static_channels = 0;\r\n                        max_channels = 1;\r\n                        automatic = no;\r\n                        automatic_param {\r\n                                window = 20s;\r\n                                add_percent = 85;\r\n                                drop_percent = 70;\r\n                                sportlich = no;\r\n                        }\r\n                }\r\n                header_compression = yes;\r\n                data_compression = pppcfg_datacomp_auto;\r\n                stac_reset_with_history_number = no;\r\n                encryption = pppcfg_crypt_none;\r\n                inactivity_prevention_interval = 0w;\r\n                new_ipaddr_on_connect = no;\r\n                my_ipaddr = 0.0.0.0;\r\n                his_ipaddr = 0.0.0.0;\r\n                overwrite_dns1 = 0.0.0.0;\r\n                overwrite_dns2 = 0.0.0.0;\r\n                bVolumeRoundUp = no;\r\n                VolumeRoundUpBytes = 0;\r\n                bProviderDisconnectPrevention = yes;\r\n                ProviderDisconnectPreventionInterval = 1d;\r\n                ProviderDisconnectPreventionHour = 1;\r\n                bProviderDisconnectPreventionHourSet = yes;\r\n                passiv_on_outgoing = no;\r\n                mode6 = mode6_off;\r\n                mode4 = mode4_normal;\r\n        }\r\n        dslglobalconfig {\r\n                autodetect = no;\r\n                autodetectparams {\r\n                        nround = 2;\r\n                        timeout = 3s;\r\n                        npacket = 1;\r\n                        autodetect_overwrite_vlancfg {\r\n                                vlanencap = vlanencap_none;\r\n                                tagtype = vlantagtype_customer;\r\n                                vlanid = 0;\r\n                                vlanprio = 0;\r\n                                tos = 0;\r\n                        }\r\n                }\r\n                pppoeiface_link_mode = link_mode_unknown;\r\n                speed_in_netto = 1024;\r\n                speed_out_netto = 99999;\r\n                manual_speed = no;\r\n                tr069_speed = no;\r\n                connect_delay_when_synced = 3s;\r\n                sync_lost_delay = 0w;\r\n                default_tcom_vlan = 7;\r\n                use_ppp_provided_speed = yes;\r\n                pppoe_send_last_sids = no;\r\n                MaxDownstreamRate = 0;\r\n                MaxUpstreamRate = 0;\r\n                RFI = 0;\r\n                DownstreamBlackoutBandStart = 0;\r\n                DownstreamBlackoutBandEnd = 0;\r\n                ControlBitfield = 0;\r\n                DownstreamMarginOffset = 0;\r\n                DownstreamPcbOffset = 0;\r\n                UpstreamPcbOffset = 0;\r\n                UsNoiseBits = 0;\r\n                RFI_mode = 0;\r\n                DsINP = 0;\r\n                DiagnosticEnabled = no;\r\n                DSLMode = 0;\r\n                IsDSLModeSet = no;\r\n                VinaxConfigBitField = 3;\r\n                DisablePTMCRCCheck = no;\r\n                sPLZ = \"\";\r\n                sMailAddr = \"\";\r\n                sDPVersion = \"\";\r\n                bAutomaticFeedbackMail = no;\r\n                nDays = 7;\r\n                nG997_1_XTSE_1_2_3_4 = 0;\r\n                nG997_1_XTSE_5_6_7_8 = 0;\r\n                nG997_1_VDSL2_PROFILES_1_2_3_4 = 0;\r\n                DisableUs1WhenDs1LatnIsAboveDb = 0;\r\n                DisableUs2WhenDs1LatnIsAboveDb = 0;\r\n                pwsGPONPLOAMPassword = \"\";\r\n                pwsGPONSerial = \"\";\r\n                pwsGPONRegId = \"\";\r\n        }\r\n        accesslist_version = 4;\r\n        ar7cfg_version = 24;\r\n        ifaceconfig_version = 18;\r\n        cfg_tainted = 2;\r\n        forwardrules_version = 5;\r\n        tr069discover_active = yes;\r\n        tr069discover_mode = only_dhcp;\r\n        tr069discover_unrestrictly = no;\r\n        tr069discover_without_dhcpoption = no;\r\n        tr069discover_vlan_takeover = no;\r\n        tr069discover_vlancfg {\r\n                vlanencap = vlanencap_none;\r\n                tagtype = vlantagtype_customer;\r\n                vlanid = 0;\r\n                vlanprio = 0;\r\n                tos = 0;\r\n        }\r\n        use_fixed_wlan_guest_ip = no;\r\n        upnp_cors_allow_origins = \"http*://scope.avm.de\";\r\n        upnp_cors_allow_headers = \"SOAPACTION\", \"Content-Type\", \"Origin\";\r\n        upnp_cors_allow_methods = \"GET\", \"POST\", \"OPTIONS\";\r\n        upnp_cors_max_age = 1d;\r\n        allow_background_comm_with_manufacturer = yes;\r\n        allow_cross_domain_comm = yes;\r\n        allow_security_report_with_manufacturer = yes;\r\n        config_externally_changed = no;\r\n        limit_tcp_ds_rate = yes;\r\n        use_gaming_opt = no;\r\n        gaming_max_ds_rate = 0;\r\n        tack_enabled = no;\r\n        tack_count = 4;\r\n        tack_period = 1;\r\n        iproute_use_first_matching_route = first_matching_auto;\r\n        guests_untrusted = no;\r\n        captive_portal_redirect_enabled = no;\r\n        captive_portal_show_law_text = no;\r\n        max_ssdp_items = -1;\r\n        provider_defaults_merged = no;\r\n        pdn1_mtu = 0;\r\n        pdn2_mtu = 0;\r\n        internet_configured = yes;\r\n        vpnmode = vpnmode_none;\r\n}\r\n\r\n\r\nservercfg {\r\n        hostname = \"(none)\";\r\n        dhcpc_hostname = \"fritz.box\";\r\n        dns1 = 192.168.180.1;\r\n        dns2 = 192.168.180.2;\r\n        public_dns_servers_use_as_fallback = yes;\r\n        public_dns_servers_v4 = 8.8.8.8, 8.8.4.4, 1.1.1.1, 1.0.0.1, 9.9.9.9,\r\n                                149.112.112.112;\r\n        public_dns_servers_v6 = 2001:4860:4860::8888, 2001:4860:4860::8844,\r\n                                2606:4700:4700::1111, 2606:4700:4700::1001,\r\n                                2620:fe::fe, 2620:fe::9;\r\n        use_user_dns_for_ipv4 = no;\r\n        user_dns1_for_ipv4 = 0.0.0.0;\r\n        user_dns2_for_ipv4 = 0.0.0.0;\r\n        use_user_dns_for_ipv6 = no;\r\n        user_dns1_for_ipv6 = ::;\r\n        user_dns2_for_ipv6 = ::;\r\n        wpad_protection = yes;\r\n        dns_over_tls_enabled = no;\r\n        dns_over_tls_strict = yes;\r\n        dns_over_tls_udp_fallback = yes;\r\n}\r\n\r\n\r\nwebsrv {\r\n        port = \"80\";\r\n        https_port = \"46675\";\r\n        wanaccess = 1;\r\n        read_timeout = 15m;\r\n        request_timeout = 30s;\r\n        keepalive_timeout = 5m;\r\n        nokeepalive = \"*\";\r\n        errordir = \"/usr/www/html/errors\";\r\n        webdir = \"/usr/www\";\r\n        cgidir = \"cgi-bin\";\r\n        indexfn = \"index.var\", \"index.htm\", \"index.html\";\r\n        users_only_for_https = yes;\r\n        cors_allow_origins = \"http*://scope.avm.de\";\r\n        cors_allow_headers = \"SOAPACTION\", \"Content-Type\", \"Origin\";\r\n        cors_allow_methods = \"GET\", \"POST\", \"OPTIONS\";\r\n        cors_max_age = 1d;\r\n}\r\n\r\n\r\nipv6 {\r\n        ulamode = ulamode_dynamic;\r\n        use_default_ula = yes;\r\n        ula = fd00::;\r\n        use_fixed_mtu = no;\r\n        fixed_mtu = 1280;\r\n        dhcpv6lanmode = dhcpv6lanmode_stateless;\r\n        dpcpv6_default_pdlen = 62;\r\n        dhcpv6_preference = 0;\r\n        dhcpv6c_use_wanted_prefixlen = no;\r\n        dhcpv6c_wanted_prefixlen = 62;\r\n        dhcpv6c_use_rapid_commit = yes;\r\n        radv {\r\n                Enabled = yes;\r\n                MinRtrAdvInterval = 450;\r\n                MaxRtrAdvInterval = 600;\r\n                AdvDefaultLifetime = 1800;\r\n                DefaultRtrPreference = 0;\r\n                PreferedLifeTime = 3600;\r\n                ValidLifeTime = 7200;\r\n                AdvDNS = yes;\r\n                OtherPrefixesAllowed = no;\r\n                AdvRouteInfo = yes;\r\n        }\r\n        ip6_6to4static_cfg {\r\n                popaddr = 0.0.0.0;\r\n                local = ::;\r\n                remote = ::;\r\n                prefix = ::;\r\n                prefixlen = 0;\r\n        }\r\n        ip6_6rd_cfg {\r\n                popaddr = 192.88.99.1;\r\n                prefix = 2002::;\r\n                prefixlen = 16;\r\n                ipv4masklen = 0;\r\n        }\r\n        ip6_static_cfg {\r\n                prefix = ::;\r\n                prefixlen = 56;\r\n                wan_use_firstprefix = yes;\r\n                wan_prefix = ::;\r\n                wan_ifid_automatic = yes;\r\n                wan_ifid = ::;\r\n                wan_dns1 = ::;\r\n                wan_dns2 = ::;\r\n        }\r\n        he {\r\n                update_server = \"ipv4.tunnelbroker.net\";\r\n                tunnel {\r\n                        popaddr = 0.0.0.0;\r\n                        local = ::;\r\n                        remote = ::;\r\n                        prefix = ::;\r\n                        prefixlen = 0;\r\n                }\r\n        }\r\n        aftr = ::;\r\n        manual_aftrfqdn = \"\";\r\n        use_gw_as_pcpserver = no;\r\n        lan_dns6_server = ::;\r\n}\r\n\r\n\r\nhybridcfg {\r\n        version = 2;\r\n        enabled = no;\r\n        primary_sync_group = \"sync_cable\";\r\n        secondary_sync_group = \"sync_lte\";\r\n        use_secondary_only_as_fallback = no;\r\n        fallback_mode = no_fallback;\r\n        autoprio {\r\n                waittime = 1m;\r\n                highkbytes = 0;\r\n                highpercent = 80;\r\n                high0 = 50;\r\n                high1 = 50;\r\n                low0 = 100;\r\n                low1 = 0;\r\n        }\r\n        autoprio_enabled = no;\r\n        fallback_session_flush_enabled = yes;\r\n        fallback_session_flush_timeout = 5m;\r\n        backup_downtime = 0w;\r\n        backup_reverttime = 0w;\r\n}\r\n\r\n\r\nlispcfg {\r\n        enabled = no;\r\n        passwd = \"\";\r\n        use_rfc6834 = no;\r\n        proxy_map_reply = no;\r\n        always_use_petr = no;\r\n        per_packet = no;\r\n        vpn_over_lisp = yes;\r\n        autoprio {\r\n                enabled = no;\r\n                upstream {\r\n                        waittime = 1m;\r\n                        highkbytes = 0;\r\n                        highpercent = 80;\r\n                        high0 = 50;\r\n                        high1 = 50;\r\n                        low0 = 100;\r\n                        low1 = 0;\r\n                }\r\n                downstream {\r\n                        waittime = 1m;\r\n                        highkbytes = 0;\r\n                        highpercent = 80;\r\n                        high0 = 50;\r\n                        high1 = 50;\r\n                        low0 = 100;\r\n                        low1 = 0;\r\n                }\r\n        }\r\n}\r\n\r\n\r\ndhcpserver {\r\n        saveinterval = 1h;\r\n        generic {\r\n                default_lease_time = 10d;\r\n                max_lease_time = 13d;\r\n                default_guest_lease_time = 6h;\r\n                max_guest_lease_time = 6h;\r\n        }\r\n        lan_dns4_server = 0.0.0.0;\r\n}\r\n\r\n\r\ndhcpclient {\r\n        metric = 9;\r\n}\r\n\r\n\r\ndnsserver {\r\n        cache_maxKB = 256;\r\n        max_negative_ttl = 1h;\r\n        latency_probe_interval = 8h;\r\n        public_fallback_disable_interval = 4h;\r\n        default_empty_ttl = 5m;\r\n}\r\n\r\n\r\nddns {\r\n        accounts {\r\n                enabled = no;\r\n                domain = \"\";\r\n                username = \"\";\r\n                passwd = \"\";\r\n                ddnsprovider = \"<userdefined>\";\r\n        }\r\n        types {\r\n                type = \"userdefined\";\r\n                url = \"\";\r\n        }\r\n        provider {\r\n                name = \"<userdefined>\";\r\n                type = \"userdefined\";\r\n                livedelay = 4m;\r\n                touchtime = 0w;\r\n                server = \"\";\r\n                ip6server = \"\";\r\n                infourl = \"http://\";\r\n                ddnsmode = ddns_v4;\r\n        }\r\n        version = 3;\r\n}\r\n\r\n\r\nwebui {\r\n        username = \"\";\r\n        password = \"\";\r\n        expertmode = yes;\r\n        event_filter = 0;\r\n        read_access_without_login = no;\r\n        cookie = \"TLV\\\\034\\\\003160\\\\023\\\\001y\\\\017\\\\0011\\\\n\\\\0012\\\\020\\\\0011\\\\013\\\\b02520757\\\\032\\\\0014\\\\022\\\\003ALL\\\\004\\\\b05011647\\\\025\\\\0011\\\\030\\\\0014\\\\006\\\\0010\";\r\n        webui_cookie_sec = \"\";\r\n        app_enabled = no;\r\n        ipv6_hidden = no;\r\n        ipv4_hidden = no;\r\n        ipv6_native_hidden = no;\r\n        ds_lite_hidden = no;\r\n        ata_hidden = no;\r\n        lanbridges_gui_hidden = yes;\r\n        voip_2ndPVC_hidden = no;\r\n        country_gui_hidden = no;\r\n        dns6_hidden = no;\r\n        skip_enternewpassword = no;\r\n        version = \"107842\";\r\n        dev_origins_enabled = no;\r\n        rest_api_webvar_filter = yes;\r\n        rest_api_endpoint_security = yes;\r\n        access_without_sid_enabled = no;\r\n        sid_timeout_minutes = 20;\r\n        data_privacy_version = \"1\";\r\n        config_imported = no;\r\n        gui_assistant_completed = 2;\r\n        userlist_hidden = no;\r\n}\r\n\r\n\r\ncapiovertcp {\r\n        enabled = no;\r\n        maxctrl = 1;\r\n        port = 5031;\r\n}\r\n\r\n\r\nemailnotify {\r\n        enabled = yes;\r\n        infoenabled = 1;\r\n        interval = weekly;\r\n        From = \"$$$$E2OUJR2TC6C25N6ACAIGVK3ZFRLOV61JGK1PBCUS5SLLQIFMBOPHW5HMHK23R5MLCY4APEPHBZ4WHAAWBSRIE6LJP1YY6K63FDBAYBPWTQFCRSAKAHK4LBJZT4QZA6D3\";\r\n        To = \"$$$$MCP5641ZI46AEHRTT4WP1NR2XDVIHFFHTCQMJCWWH542DTB46SWB6W44DLBT5HQB5U61LZ1E36XRM6BA\";\r\n        SMTPServer = \"smtp.dreamhost.com:465\";\r\n        accountname = \"$$$$MYUAXPEO2HARAUJ6QKDT5RRNKFLTZ1UBRGWD2ZNQJPY3XNAKRBR1VS1A1LNXIK3UJHG1FIOKSPHUU6BA\";\r\n        passwd = \"$$$$FJL3M5SP6KEI2J1ZF2B1B6UVDMP5DVED6YJKZHIWVOXTMVWBU2DRVX4FSEMKZY64XCM45MD11R1AQ6BA\";\r\n        show_eventlist = no;\r\n        show_voipstat = yes;\r\n        show_kidsstat = yes;\r\n        show_onlinecntstat = yes;\r\n        show_fonstat = yes;\r\n        show_network_list = yes;\r\n        starttls = yes;\r\n        enable_incident_supportdata = no;\r\n        enable_startup_supportdata = no;\r\n        crashreport_mode = to_support_only;\r\n        crashreport_name = \"\";\r\n        dsl_detail = no;\r\n        enable_connect_mail = no;\r\n        connect_mail_To = \"\";\r\n        reset_pwd_enabled = yes;\r\n        FWUpdatehint {\r\n                enabled = yes;\r\n                To = \"\";\r\n        }\r\n        Config {\r\n                enabled = no;\r\n                To = \"\";\r\n                arg0 = \"\";\r\n        }\r\n        WlanGuestStatus {\r\n                enabled = no;\r\n                To = \"\";\r\n        }\r\n        SecurityMail {\r\n                enabled = yes;\r\n                To = \"$$$$IR6ICRPW1OOY614YHBJMCAYBQCBEUXXAFK5Y1DMDLJAC2IAR4N61PGNCXBKSTVOHT63PWQ5CFJSETPAV\";\r\n                Login = no;\r\n        }\r\n        supportdata_enhanced = yes;\r\n        mesh_auto_update = no;\r\n        meshmaster_hostname = \"(none)\";\r\n        meshmaster_productname = \"FRITZ!Box 6660 Cable\";\r\n        config_flags = 0;\r\n}\r\n\r\n\r\nbackendsupport {\r\n        timestamp = \"1970-01-01 00:00:00\";\r\n        url = \"\";\r\n        id = \"\";\r\n        mode = eBsModeUnknown;\r\n        status = eBsStatusUnknown;\r\n        sync = eBsSyncNo;\r\n}\r\n\r\n\r\nnight_time_control {\r\n        enabled = no;\r\n        time_on = \"\";\r\n        time_off = \"\";\r\n        ring_blocked = no;\r\n}\r\n\r\n\r\nntpclient {\r\n        server_list = \"2.europe.pool.ntp.org\";\r\n        fallback_server = \"\";\r\n        chrony_enabled = yes;\r\n}\r\n\r\n\r\nled {\r\n        infoled_reason = 4;\r\n        control = led_on;\r\n        button_events_disable = no;\r\n        led_dim_enabled = yes;\r\n        led_dim_mode = 1;\r\n        led_dim_brightness = 100;\r\n}\r\n\r\n\r\ntimezone_manual {\r\n        enabled = no;\r\n        offset = 0;\r\n        dst_enabled = no;\r\n        TZ_string = \"\";\r\n}\r\n\r\n\r\nmrouter {\r\n        igmp_version_for_upstream = 3;\r\n        igmp_version_for_other = 3;\r\n        igmp_prio = 48;\r\n        ssm_enabled = yes;\r\n}\r\n\r\n\r\nrip {\r\n}\r\n\r\n\r\ncpu_schedule {\r\n        dsl_token = 5000;\r\n        lan_token = 20000;\r\n}\r\n\r\n\r\nTR_064 {\r\n        enabled = yes;\r\n        username = \"dslf-config\";\r\n        persistent_data = \"\";\r\n        only_https = no;\r\n        doupdate_require_auth = no;\r\n        udn = \"uuid:739f2409-bccb-40e7-8e6c-B0F208038D21\";\r\n        origin_udn = \"\";\r\n}\r\n\r\n\r\nlandevices {\r\n        landevices_version = 4;\r\n        landevices {\r\n                ip = 192.168.178.22;\r\n                manual_ip = no;\r\n                uniqid = 6108;\r\n                name = \"adrianhandy\";\r\n                friendly_name = \"Adrian Handy\";\r\n                neighbour_name = \"Adrian Handy\";\r\n                mac = 8A:2A:AE:67:56:50;\r\n                auto_etherwake = no;\r\n                ifaceid = ::;\r\n                staticlease = no;\r\n                url_status = eLUrlStatusNotAvailable;\r\n                ipv4_exposed_host = no;\r\n                allow_pcp_and_upnp = no;\r\n        } {\r\n                ip = 192.168.178.23;\r\n                manual_ip = no;\r\n                uniqid = 2038;\r\n                name = \"philpc\";\r\n                friendly_name = \"Phil PC\";\r\n                neighbour_name = \"DESKTOP-4D5TGHU\";\r\n                mac = 70:85:C2:71:16:D7;\r\n                auto_etherwake = no;\r\n                ifaceid = ::;\r\n                staticlease = no;\r\n                url_status = eLUrlStatusNotAvailable;\r\n                ipv4_exposed_host = no;\r\n                maclist = 70:85:C2:71:16:D7;\r\n                allow_pcp_and_upnp = yes;\r\n        } {\r\n                ip = 192.168.178.24;\r\n                manual_ip = no;\r\n                uniqid = 6107;\r\n                name = \"pico4\";\r\n                friendly_name = \"PICO 4\";\r\n                neighbour_name = \"Android\";\r\n                mac = 08:16:D5:5E:69:3B;\r\n                auto_etherwake = yes;\r\n                ifaceid = ::13d8:3d89:e509:16bd;\r\n                staticlease = yes;\r\n                url_status = eLUrlStatusNotAvailable;\r\n                ipv4_exposed_host = no;\r\n                allow_pcp_and_upnp = yes;\r\n        } {\r\n                ip = 192.168.178.26;\r\n                manual_ip = no;\r\n                uniqid = 6106;\r\n                name = \"AppleTV\";\r\n                friendly_name = \"AppleTV\";\r\n                neighbour_name = \"Fickzimmer\";\r\n                mac = 08:66:98:98:69:7C;\r\n                auto_etherwake = yes;\r\n                ifaceid = ::452:325e:2d6a:93ef;\r\n                staticlease = no;\r\n                url_status = eLUrlStatusNotAvailable;\r\n                ipv4_exposed_host = no;\r\n                allow_pcp_and_upnp = yes;\r\n        } {\r\n                ip = 192.168.178.27;\r\n                manual_ip = no;\r\n                uniqid = 6111;\r\n                name = \"sasuhandy\";\r\n                friendly_name = \"Sasu Handy\";\r\n                neighbour_name = \"S23-Ultra-von-Sasu\";\r\n                mac = 42:49:2C:87:9A:0C;\r\n                auto_etherwake = no;\r\n                ifaceid = ::;\r\n                staticlease = no;\r\n                url_status = eLUrlStatusNotAvailable;\r\n                ipv4_exposed_host = no;\r\n                allow_pcp_and_upnp = no;\r\n        } {\r\n                ip = 192.168.178.28;\r\n                manual_ip = no;\r\n                uniqid = 6112;\r\n                name = \"sasulaptop\";\r\n                friendly_name = \"Sasu Laptop\";\r\n                neighbour_name = \"DESKTOP-P8O3O2J\";\r\n                mac = 2C:3B:70:6D:57:03;\r\n                auto_etherwake = no;\r\n                ifaceid = ::2345:bfd1:ccca:ec14;\r\n                staticlease = no;\r\n                url_status = eLUrlStatusNotAvailable;\r\n                ipv4_exposed_host = no;\r\n                allow_pcp_and_upnp = yes;\r\n        } {\r\n                ip = 192.168.178.30;\r\n                manual_ip = yes;\r\n                uniqid = 6113;\r\n                neighbour_name = \"OMEN\";\r\n                mac = A8:93:4A:C8:98:29;\r\n                auto_etherwake = no;\r\n                ifaceid = ::c113:9ba7:e8b4:7537;\r\n                staticlease = yes;\r\n                url_status = eLUrlStatusNotAvailable;\r\n                ipv4_exposed_host = no;\r\n                allow_pcp_and_upnp = yes;\r\n        } {\r\n                ip = 192.168.178.50;\r\n                manual_ip = yes;\r\n                uniqid = 6124;\r\n                neighbour_name = \"OMEN\";\r\n                mac = C8:5A:CF:B0:2A:83;\r\n                auto_etherwake = no;\r\n                ifaceid = ::1a9b:2dfd:4eda:836;\r\n                staticlease = yes;\r\n                url_status = eLUrlStatusNotAvailable;\r\n                ipv4_exposed_host = no;\r\n                maclist = C8:5A:CF:B0:2A:83;\r\n                allow_pcp_and_upnp = yes;\r\n        } {\r\n                ip = 192.168.178.100;\r\n                manual_ip = yes;\r\n                uniqid = 5503;\r\n                name = \"Drucker\";\r\n                friendly_name = \"Drucker\";\r\n                neighbour_name = \"KM33C6ED\";\r\n                mac = 00:17:C8:33:C6:ED;\r\n                auto_etherwake = no;\r\n                ifaceid = ::217:c8ff:fe33:c6ed;\r\n                staticlease = yes;\r\n                url_status = eLUrlStatusAvailable;\r\n                ipv4_exposed_host = no;\r\n                allow_pcp_and_upnp = yes;\r\n        }\r\n}\r\n\r\n\r\nmultiwan {\r\n        multiwan_enabled = no;\r\n        with_voip_pdn = no;\r\n        with_vlan_pdn = no;\r\n        ipv6_lte {\r\n                enabled = no;\r\n                ipv6mode = ipv6_off;\r\n                ipv4mode = ipv4_normal;\r\n                use_fixed_mtu = no;\r\n                fixed_mtu = 1280;\r\n                dhcpv6c_use_wanted_prefixlen = no;\r\n                dhcpv6c_wanted_prefixlen = 62;\r\n                dhcpv6c_use_rapid_commit = yes;\r\n                ip6_6to4static_cfg {\r\n                        popaddr = 0.0.0.0;\r\n                        local = ::;\r\n                        remote = ::;\r\n                        prefix = ::;\r\n                        prefixlen = 0;\r\n                }\r\n                ip6_6rd_cfg {\r\n                        popaddr = 192.88.99.1;\r\n                        prefix = 2002::;\r\n                        prefixlen = 16;\r\n                        ipv4masklen = 0;\r\n                }\r\n                ip6_static_cfg {\r\n                        prefix = ::;\r\n                        prefixlen = 56;\r\n                        wan_use_firstprefix = yes;\r\n                        wan_prefix = ::;\r\n                        wan_ifid_automatic = yes;\r\n                        wan_ifid = ::;\r\n                        wan_dns1 = ::;\r\n                        wan_dns2 = ::;\r\n                }\r\n                hurricane_electric {\r\n                        update_server = \"ipv4.tunnelbroker.net\";\r\n                        tunnel {\r\n                                popaddr = 0.0.0.0;\r\n                                local = ::;\r\n                                remote = ::;\r\n                                prefix = ::;\r\n                                prefixlen = 0;\r\n                        }\r\n                }\r\n                aftr = ::;\r\n                manual_aftrfqdn = \"\";\r\n                use_gw_as_pcpserver = no;\r\n        }\r\n}\r\n\r\n\r\nprios {\r\n        profiles {\r\n                name = \"profile_http\";\r\n                profile_id = \"1\";\r\n                rules = \"TCP 80 0 0 0\";\r\n                filter = \"reject tcp any eq 80 any\";\r\n        } {\r\n                name = \"profile_ftp\";\r\n                profile_id = \"2\";\r\n                rules = \"TCP 20 21 0 0\";\r\n                filter = \"reject tcp any range 20 21 any\";\r\n        } {\r\n                name = \"profile_torrent\";\r\n                profile_id = \"3\";\r\n                rules = \"TCP 0 0 6881 6999\";\r\n                filter = \"reject tcp any any range 6881 6999\";\r\n        } {\r\n                name = \"profile_rdp\";\r\n                profile_id = \"4\";\r\n                rules = \"TCP 3389 0 0 0\";\r\n                filter = \"reject tcp any eq 3389 any\";\r\n        } {\r\n                name = \"profile_ssh\";\r\n                profile_id = \"5\";\r\n                rules = \"TCP 0 0 22 0\";\r\n                filter = \"reject tcp any any eq 22\";\r\n        } {\r\n                name = \"profile_telnet\";\r\n                profile_id = \"6\";\r\n                rules = \"TCP 0 0 23 0\";\r\n                filter = \"reject tcp any any eq 23\";\r\n        } {\r\n                name = \"profile_not_surf\";\r\n                profile_id = \"7\";\r\n                rules = \"TCP 0 0 1 24\", \"TCP 0 0 26 79\", \"TCP 0 0 81 109\",\r\n                        \"TCP 0 0 111 142\", \"TCP 0 0 144 442\",\r\n                        \"TCP 0 0 444 464\", \"TCP 0 0 466 586\",\r\n                        \"TCP 0 0 588 992\", \"TCP 0 0 994 994\",\r\n                        \"TCP 0 0 996 8079\", \"TCP 0 0 8081 65535\",\r\n                        \"UDP 0 0 0 0\";\r\n                filter = \"reject tcp any any range 1 24\",\r\n                         \"reject tcp any any range 26 79\",\r\n                         \"reject tcp any any range 81 109\",\r\n                         \"reject tcp any any range 111 142\",\r\n                         \"reject tcp any any range 144 442\",\r\n                         \"reject tcp any any range 444 464\",\r\n                         \"reject tcp any any range 466 586\",\r\n                         \"reject tcp any any range 588 992\",\r\n                         \"reject tcp any any range 994 994\",\r\n                         \"reject tcp any any range 996 8079\",\r\n                         \"reject tcp any any range 8081 65535\",\r\n                         \"reject udp any any\";\r\n        }\r\n}\r\n\r\n\r\nnqos {\r\n        version = 16;\r\n        macaddr_whitelist_enabled = no;\r\n        bridge_with_switch_separation = yes;\r\n        bridge_lp_mode = -1;\r\n        patch1TR114 = no;\r\n        defaultresult {\r\n                tos = -1;\r\n                vlan_prio = -1;\r\n                queueref = \"default\";\r\n        }\r\n        appls {\r\n                enabled = yes;\r\n                name = \"sip-appl\";\r\n                protocol = qos_classifier_appl_sip;\r\n                result {\r\n                        tos = -1;\r\n                        vlan_prio = -1;\r\n                        queueref = \"hrealtime\";\r\n                }\r\n        }\r\n        classifiers {\r\n                enabled = yes;\r\n                name = \"profile_all:PC-70:85:C2:71:16:D7\";\r\n                type = qos_cfg_other;\r\n                iface = qos_lan;\r\n                rule = \"eth.source 70:85:C2:71:16:D7\";\r\n                result {\r\n                        tos = -1;\r\n                        vlan_prio = -1;\r\n                        queueref = \"realtime\";\r\n                }\r\n        } {\r\n                enabled = yes;\r\n                name = \"profile_all:PC-C8:5A:CF:B0:2A:83\";\r\n                type = qos_cfg_other;\r\n                iface = qos_lan;\r\n                rule = \"eth.source C8:5A:CF:B0:2A:83\";\r\n                result {\r\n                        tos = -1;\r\n                        vlan_prio = -1;\r\n                        queueref = \"realtime\";\r\n                }\r\n        } {\r\n                enabled = yes;\r\n                name = \"profile_all:PC-08:16:D5:5E:69:3B\";\r\n                type = qos_cfg_other;\r\n                iface = qos_lan;\r\n                rule = \"eth.source 08:16:D5:5E:69:3B\";\r\n                result {\r\n                        tos = -1;\r\n                        vlan_prio = -1;\r\n                        queueref = \"realtime\";\r\n                }\r\n        } {\r\n                enabled = yes;\r\n                name = \"clfy_voip\";\r\n                type = qos_cfg_internal;\r\n                iface = qos_local;\r\n                rule = \"localmark sip\";\r\n                result {\r\n                        tos = -1;\r\n                        vlan_prio = -1;\r\n                        queueref = \"hrealtime\";\r\n                }\r\n        } {\r\n                enabled = yes;\r\n                name = \"clfy_voip\";\r\n                type = qos_cfg_internal;\r\n                iface = qos_local;\r\n                rule = \"localmark rtp\";\r\n                result {\r\n                        tos = -1;\r\n                        vlan_prio = -1;\r\n                        queueref = \"hrealtime\";\r\n                }\r\n        } {\r\n                enabled = yes;\r\n                name = \"clfy_voip\";\r\n                type = qos_cfg_internal;\r\n                iface = qos_local;\r\n                rule = \"localmark sip_internet\";\r\n                result {\r\n                        tos = -1;\r\n                        vlan_prio = -1;\r\n                        queueref = \"hrealtime\";\r\n                }\r\n        } {\r\n                enabled = yes;\r\n                name = \"clfy_voip\";\r\n                type = qos_cfg_internal;\r\n                iface = qos_local;\r\n                rule = \"localmark rtp_internet\";\r\n                result {\r\n                        tos = -1;\r\n                        vlan_prio = -1;\r\n                        queueref = \"hrealtime\";\r\n                }\r\n        } {\r\n                enabled = yes;\r\n                name = \"tr069\";\r\n                type = qos_cfg_hidden;\r\n                iface = qos_local;\r\n                rule = \"localmark sipdns,ntpdns,tr069dns,tr069\";\r\n                result {\r\n                        tos = -1;\r\n                        vlan_prio = -1;\r\n                        queueref = \"hprio\";\r\n                }\r\n        } {\r\n                enabled = yes;\r\n                name = \"igmp\";\r\n                type = qos_cfg_hidden;\r\n                iface = qos_local;\r\n                rule = \"localmark igmp\";\r\n                result {\r\n                        tos = -1;\r\n                        vlan_prio = -1;\r\n                        queueref = \"ifacectl\";\r\n                }\r\n        } {\r\n                enabled = yes;\r\n                name = \"webdav\";\r\n                type = qos_cfg_hidden;\r\n                iface = qos_local;\r\n                rule = \"localmark webdav\";\r\n                result {\r\n                        tos = -1;\r\n                        vlan_prio = -1;\r\n                        queueref = \"low\";\r\n                }\r\n        } {\r\n                enabled = yes;\r\n                name = \"dns\";\r\n                type = qos_cfg_hidden;\r\n                iface = qos_local;\r\n                rule = \"localmark dns\";\r\n                result {\r\n                        tos = -1;\r\n                        vlan_prio = -1;\r\n                        queueref = \"hprio\";\r\n                }\r\n        } {\r\n                enabled = yes;\r\n                name = \"mstv\";\r\n                type = qos_cfg_hidden;\r\n                iface = qos_lan;\r\n                rule = \"udp.dport 43962,47806\";\r\n                result {\r\n                        tos = -1;\r\n                        vlan_prio = -1;\r\n                        queueref = \"hprio\";\r\n                }\r\n        } {\r\n                enabled = yes;\r\n                name = \"icmp-v6\";\r\n                type = qos_cfg_hidden;\r\n                iface = qos_lan;\r\n                rule = \"ip.proto IPv6-ICMP\";\r\n                result {\r\n                        tos = -1;\r\n                        vlan_prio = -1;\r\n                        queueref = \"hprio\";\r\n                }\r\n        } {\r\n                enabled = yes;\r\n                name = \"icmp\";\r\n                type = qos_cfg_hidden;\r\n                iface = qos_lan;\r\n                rule = \"ip.proto icmp\";\r\n                result {\r\n                        tos = -1;\r\n                        vlan_prio = -1;\r\n                        queueref = \"hprio\";\r\n                }\r\n        } {\r\n                enabled = yes;\r\n                name = \"dns\";\r\n                type = qos_cfg_hidden;\r\n                iface = qos_lan;\r\n                rule = \"udp.dport 53\";\r\n                result {\r\n                        tos = -1;\r\n                        vlan_prio = -1;\r\n                        queueref = \"hprio\";\r\n                }\r\n        } {\r\n                enabled = yes;\r\n                name = \"clfy_voip\";\r\n                type = qos_cfg_internal;\r\n                iface = qos_lan;\r\n                rule = \"udp.dport 5060\";\r\n                result {\r\n                        tos = -1;\r\n                        vlan_prio = -1;\r\n                        queueref = \"hrealtime\";\r\n                        applref = \"sip-appl\";\r\n                }\r\n        } {\r\n                enabled = no;\r\n                name = \"clfy_www\";\r\n                type = qos_cfg_system;\r\n                iface = qos_lan;\r\n                rule = \"tcp.dest 80,3128,8080 ip.len <= 800\";\r\n                result {\r\n                        tos = -1;\r\n                        vlan_prio = -1;\r\n                        queueref = \"none\";\r\n                }\r\n        } {\r\n                enabled = yes;\r\n                name = \"clfy_voip\";\r\n                type = qos_cfg_internal;\r\n                iface = qos_lan;\r\n                rule = \"tcp.dport 5060\";\r\n                result {\r\n                        tos = -1;\r\n                        vlan_prio = -1;\r\n                        queueref = \"hrealtime\";\r\n                        applref = \"sip-appl\";\r\n                }\r\n        } {\r\n                enabled = yes;\r\n                name = \"lcp\";\r\n                type = qos_cfg_hidden;\r\n                iface = qos_local;\r\n                rule = \"localmark lcp\";\r\n                result {\r\n                        tos = -1;\r\n                        vlan_prio = -1;\r\n                        queueref = \"ifacectl\";\r\n                }\r\n        }\r\n        queues {\r\n                enabled = yes;\r\n                with_sfq = no;\r\n                type = qos_cfg_system;\r\n                name = \"ifacectl\";\r\n                iface = qos_wan;\r\n                queue_type = queue_llq;\r\n                precedence = 0;\r\n                weight = 0;\r\n                shapingrate = 0;\r\n                shapingburst = 0;\r\n                allow_more = yes;\r\n                ceilrate = 0;\r\n        } {\r\n                enabled = yes;\r\n                with_sfq = no;\r\n                type = qos_cfg_system;\r\n                name = \"hprio\";\r\n                iface = qos_wan;\r\n                queue_type = queue_llq;\r\n                precedence = 10;\r\n                weight = 0;\r\n                shapingrate = 0;\r\n                shapingburst = 0;\r\n                allow_more = yes;\r\n                ceilrate = 0;\r\n        } {\r\n                enabled = yes;\r\n                with_sfq = no;\r\n                type = qos_cfg_system;\r\n                name = \"hrealtime\";\r\n                iface = qos_wan;\r\n                queue_type = queue_llq;\r\n                precedence = 20;\r\n                weight = 0;\r\n                shapingrate = 0;\r\n                shapingburst = 0;\r\n                allow_more = yes;\r\n                ceilrate = 0;\r\n        } {\r\n                enabled = yes;\r\n                with_sfq = yes;\r\n                type = qos_cfg_system;\r\n                name = \"realtime\";\r\n                iface = qos_wan;\r\n                queue_type = queue_llq;\r\n                precedence = 30;\r\n                weight = 0;\r\n                shapingrate = 0;\r\n                shapingburst = 0;\r\n                allow_more = yes;\r\n                ceilrate = 0;\r\n        } {\r\n                enabled = yes;\r\n                with_sfq = yes;\r\n                type = qos_cfg_system;\r\n                name = \"important\";\r\n                iface = qos_wan;\r\n                queue_type = queue_llq;\r\n                precedence = 100;\r\n                weight = 0;\r\n                shapingrate = 0;\r\n                shapingburst = 0;\r\n                allow_more = yes;\r\n                ceilrate = 0;\r\n        } {\r\n                enabled = yes;\r\n                with_sfq = yes;\r\n                type = qos_cfg_system;\r\n                name = \"default\";\r\n                iface = qos_wan;\r\n                queue_type = queue_llq;\r\n                precedence = 150;\r\n                weight = 0;\r\n                shapingrate = 0;\r\n                shapingburst = 0;\r\n                allow_more = yes;\r\n                ceilrate = 0;\r\n        } {\r\n                enabled = yes;\r\n                with_sfq = yes;\r\n                type = qos_cfg_system;\r\n                name = \"low\";\r\n                iface = qos_wan;\r\n                queue_type = queue_llq;\r\n                precedence = 200;\r\n                weight = 0;\r\n                shapingrate = 0;\r\n                shapingburst = 0;\r\n                allow_more = yes;\r\n                ceilrate = 0;\r\n        }\r\n        ratelimits {\r\n                enabled = yes;\r\n                name = \"dhcpv6\";\r\n                type = qos_cfg_system;\r\n                iface = qos_lan;\r\n                rule = \"ip.version 6 udp.dport 547\";\r\n                packets = 10;\r\n                interval = 1s;\r\n                early = 0;\r\n        } {\r\n                enabled = yes;\r\n                name = \"rs\";\r\n                type = qos_cfg_system;\r\n                iface = qos_lan;\r\n                rule = \"ip.version 6 icmp.type 133\";\r\n                packets = 10;\r\n                interval = 1s;\r\n                early = 0;\r\n        } {\r\n                enabled = yes;\r\n                name = \"ns\";\r\n                type = qos_cfg_system;\r\n                iface = qos_lan;\r\n                rule = \"ip.version 6 icmp.type 135\";\r\n                packets = 10;\r\n                interval = 1s;\r\n                early = 0;\r\n        } {\r\n                enabled = yes;\r\n                name = \"na\";\r\n                type = qos_cfg_system;\r\n                iface = qos_lan;\r\n                rule = \"ip.version 6 icmp.type 136\";\r\n                packets = 500;\r\n                interval = 1s;\r\n                early = 0;\r\n        } {\r\n                enabled = yes;\r\n                name = \"icmpUnreachable\";\r\n                type = qos_cfg_system;\r\n                iface = qos_lan;\r\n                rule = \"ip.version 6 icmp.type 1\";\r\n                packets = 10;\r\n                interval = 1s;\r\n                early = 0;\r\n        } {\r\n                enabled = yes;\r\n                name = \"icmpTooBig\";\r\n                type = qos_cfg_system;\r\n                iface = qos_lan;\r\n                rule = \"ip.version 6 icmp.type 2\";\r\n                packets = 10;\r\n                interval = 1s;\r\n                early = 0;\r\n        } {\r\n                enabled = yes;\r\n                name = \"icmpTimeExceeded\";\r\n                type = qos_cfg_system;\r\n                iface = qos_lan;\r\n                rule = \"ip.version 6 icmp.type 3\";\r\n                packets = 10;\r\n                interval = 1s;\r\n                early = 0;\r\n        } {\r\n                enabled = yes;\r\n                name = \"icmpEchoRequest\";\r\n                type = qos_cfg_system;\r\n                iface = qos_lan;\r\n                rule = \"ip.version 6 icmp.type 128\";\r\n                packets = 10;\r\n                interval = 1s;\r\n                early = 0;\r\n        } {\r\n                enabled = yes;\r\n                name = \"icmpEchoReply\";\r\n                type = qos_cfg_system;\r\n                iface = qos_lan;\r\n                rule = \"ip.version 6 icmp.type 129\";\r\n                packets = 10;\r\n                interval = 1s;\r\n                early = 0;\r\n        } {\r\n                enabled = yes;\r\n                name = \"dhcpv4\";\r\n                type = qos_cfg_system;\r\n                iface = qos_lan;\r\n                rule = \"ip.version 4 udp.dport 67\";\r\n                packets = 20;\r\n                interval = 1s;\r\n                early = 0;\r\n        } {\r\n                enabled = yes;\r\n                name = \"TCPsynFlag\";\r\n                type = qos_cfg_system;\r\n                iface = qos_wan;\r\n                rule = \"tcp.flags 0x002/0xfff\";\r\n                packets = 1000;\r\n                interval = 1s;\r\n                early = 0;\r\n        } {\r\n                enabled = yes;\r\n                name = \"ra\";\r\n                type = qos_cfg_system;\r\n                iface = qos_lan;\r\n                rule = \"ip.version 6 icmp.type 134\";\r\n                packets = 10;\r\n                interval = 1s;\r\n                early = 1;\r\n        }\r\n        dyn_queues {\r\n                enabled = yes;\r\n                queueref = \"default\";\r\n                tack_queueref = \"important\";\r\n                tget_queueref = \"realtime\";\r\n        }\r\n        regulation {\r\n                enabled = no;\r\n                type = moderate;\r\n                queues {\r\n                        enabled = yes;\r\n                        queueref = \"important\";\r\n                        ds_weight_min = 10;\r\n                        ds_weight_max = 0;\r\n                } {\r\n                        enabled = no;\r\n                        queueref = \"default\";\r\n                        ds_weight_min = 10;\r\n                        ds_weight_max = 0;\r\n                } {\r\n                        enabled = yes;\r\n                        queueref = \"low\";\r\n                        ds_weight_min = 10;\r\n                        ds_weight_max = 0;\r\n                }\r\n        }\r\n}\r\n\r\n\r\neth_port_config {\r\n        version = 12;\r\n        port {\r\n                portnumber = 1;\r\n                maxspeed = 2500;\r\n                config_mode = mode_normal;\r\n                dev = \"nsgmii0\";\r\n                label = \"LAN:1\";\r\n                eee_mode = eth_eee_mode_auto;\r\n        } {\r\n                portnumber = 2;\r\n                maxspeed = 1000;\r\n                config_mode = mode_normal;\r\n                dev = \"eth0\";\r\n                label = \"LAN:2\";\r\n                eee_mode = eth_eee_mode_auto;\r\n        } {\r\n                portnumber = 3;\r\n                maxspeed = 1000;\r\n                config_mode = mode_normal;\r\n                dev = \"eth1\";\r\n                label = \"LAN:3\";\r\n                eee_mode = eth_eee_mode_auto;\r\n        } {\r\n                portnumber = 4;\r\n                maxspeed = 1000;\r\n                config_mode = mode_normal;\r\n                dev = \"eth2\";\r\n                label = \"LAN:4\";\r\n                eee_mode = eth_eee_mode_auto;\r\n        } {\r\n                portnumber = 5;\r\n                maxspeed = 1000;\r\n                config_mode = mode_normal;\r\n                dev = \"eth3\";\r\n                label = \"LAN:5\";\r\n                eee_mode = eth_eee_mode_auto;\r\n        }\r\n        default_guest_ethernet_port = \"LAN:5\";\r\n        eee_off_for_all_ports = yes;\r\n}\r\n\r\n\r\nethernet_eco {\r\n}\r\n\r\n\r\nunattended_update {\r\n        update_found = no;\r\n        running_version = \"\";\r\n        no_update_found_time = \"2023-10-15 01:23:54\";\r\n        update_found_time = \"1970-01-01 00:00:00\";\r\n        priority = 0;\r\n        check_intervall = 12;\r\n        enabled = yes;\r\n        auto_update_enable = yes;\r\n        auto_update_all_enabled = yes;\r\n        info_url = \"\";\r\n        cfg_version = 2;\r\n        auto_update_last_check_time = \"2023-10-15 01:23:54\";\r\n        update_found_version = \"\";\r\n        fwupdatehintmail_time = \"1970-01-01 00:00:00\";\r\n        predownload_url = \"\";\r\n        maintenance_window_enabled = no;\r\n        maintenance_window_start = 1d;\r\n}\r\n\r\n\r\navmlogd {\r\n        enabled = no;\r\n        redzonecheck = no;\r\n}\r\n\r\n\r\nspeedtest {\r\n        enabled = no;\r\n        bidirect_enabled = no;\r\n        wanaccess = no;\r\n        twamp {\r\n                enabled = no;\r\n                port = 862;\r\n                maxttl = 255;\r\n        }\r\n}\r\n\r\n\r\nprovider_default {\r\n}\r\n\r\n\r\njasonii {\r\n        enabled = no;\r\n        user_email = \"\";\r\n        box_id = \"\";\r\n        box_id_passphrase = \"\";\r\n        dyn_dns_name = \"\";\r\n        upstream_sync_pending = yes;\r\n        https_username_sync = no;\r\n        box_register_tries = 0;\r\n}\r\n\r\n\r\nboxusers {\r\n        users {\r\n                enabled = yes;\r\n                id = 38;\r\n                name = \"$$$$CJC3VTXJK55U43XZHZFSU5ULIKLODLQGJGFPK162CBGNE51TILWV1WM3UJ5BQQQ2CHFG2E6K3LVLM5GB\";\r\n                email = \"\";\r\n                password = \"$$$$G26U1HMARG4UZ4YQUBYN44KRZRU1G2RNXTZRXIK5Y3BA1ABHSZXKK3FSNIC3CCA2AA4TQPVAYSGZA5GB\";\r\n                vpn_access = no;\r\n                googleauth_sharedsecret = \"\";\r\n                googleauth_devicename = \"\";\r\n                googleauth_setupdate = \"1970-01-01 00:00:00\";\r\n                box_admin_rights = secobj_access_rights_readwrite_from_homenetwork_only;\r\n                nas_rights = secobj_access_rights_readwrite_from_homenetwork_only;\r\n                phone_rights = secobj_access_rights_readwrite_from_homenetwork_only;\r\n                homeauto_rights = secobj_access_rights_readwrite_from_homenetwork_only;\r\n        }\r\n        remote_access_id = 0;\r\n        version = 2;\r\n        two_factor_auth_enabled = no;\r\n        tfa_cfg_version = 1;\r\n        myfritz_boxuser_id = 0;\r\n}\r\n\r\n\r\npowerline {\r\n        enabled = yes;\r\n        allow_standby = yes;\r\n        en = yes;\r\n        power_save_ex = 1;\r\n        auto_update_all_enabled = yes;\r\n        version = 2;\r\n}\r\n\r\n\r\nnas_cpu {\r\n        ip = 192.168.178.254;\r\n        https_ipv4_external_port = 4443;\r\n}\r\n\r\n\r\nhotspotcfg {\r\n}\r\n\r\n\r\nl2tpcfg {\r\n        master_disabled = no;\r\n        fixed_server = 0.0.0.0;\r\n}\r\n\r\n\r\napps {\r\n        apps {\r\n                app_id = 21;\r\n                id = \"FRITZZAppZFonZ719d06c50b2c84f7\";\r\n                device_mac = 00:00:00:00:00:00;\r\n                displayname = \"FRITZ!\\\\342\\\\201\\\\240App\\\\302\\\\240Fon (Sony XQ-CC54)\";\r\n                username = \"$$$$C2BXJV2IMHWRADGF2Q4PFVLGBM2GEQHNYOFVC2RF3DROBTKTESRGMUQTZBP4234NOCCXMLP5DMYITT1DRQU4OJYCUC6HCS5VH1OJPT4F\";\r\n                password = \"$$$$RJQWDAWV23JOLKQUT5ZCK31VVCEMAZMV22SHV2DJKY4HEFNTK4Z4E515VEGGGX1BEKM6IJWIQ6DDPH4R55GAY5CYHZ46V2DFRHGIVEFF\";\r\n                userid = 38;\r\n                internet_rights = no;\r\n                app_rights = secobj_access_rights_none;\r\n                nas_rights = secobj_access_rights_none;\r\n                phone_rights = secobj_access_rights_readwrite_from_everywhere;\r\n                homeauto_rights = secobj_access_rights_none;\r\n                appavmaddress = \"MzY3OTdlMjg1MjFlNDBlMGI3MDI5Mjg1MTZkMTM4MjQ.0eaM3akRy6VDZeb9M8RYsqxSdkEqxMfa5Fw9bMdVu0s\";\r\n                appavmpwdhash = \"\";\r\n                cryptalgos = \"A256GCM\";\r\n                filter {\r\n                        type = app_msg_filter_tel_local_number;\r\n                        list = \"023113790733\", \" 023113791006\";\r\n                }\r\n                registered_with_boxadmin_rights = yes;\r\n        } {\r\n                app_id = 24;\r\n                id = \"719d06c50b2c84f7release\";\r\n                device_mac = 00:00:00:00:00:00;\r\n                displayname = \"MyFRITZ!\\\\342\\\\201\\\\240App (Sony XQ-CC54)\";\r\n                username = \"$$$$XH4HPXBKZR1OBYBEXQOFLJMKPXTBTP3LZGWOAH3NE5JIMD56OSZKPCIJ41WINKE3JTVYRU5ZOV6ELKBMDAJSG1MLN4KVDTOVJHE6AU4F\";\r\n                password = \"$$$$PIIDB36FNRRMMLQ1ZLETGVPWFI36FOYMRHUCMDU2QJJ4TIC6RX1NWELIIGYXP64VHSWU6A46LKINFFZSIO33IYDY2VKGPLHPNI6HQ4NF\";\r\n                userid = 38;\r\n                internet_rights = yes;\r\n                app_rights = secobj_access_rights_readwrite_from_everywhere;\r\n                nas_rights = secobj_access_rights_readwrite_from_everywhere;\r\n                phone_rights = secobj_access_rights_readwrite_from_everywhere;\r\n                homeauto_rights = secobj_access_rights_readwrite_from_everywhere;\r\n                appavmaddress = \"YjhmYmJhMTgzNjE0NDk5MTk4ZDBkODA1MGYwNmQzNWU.HvPpGvfaqqWVa_xYExkcKA51C-KnE_PWU1vPBaINDOE\";\r\n                appavmpwdhash = \"\";\r\n                cryptalgos = \"A256GCM\";\r\n                registered_with_boxadmin_rights = yes;\r\n        }\r\n        box_senderid = \"B0F208038D21pSRGHDA42W\";\r\n        enc_secret = \"$$$$JPG642LGOFAZ3NUPL5XTQHGIDIACZMASXBXCZHEYRDVEHJJD15PWMTSIYOITE6Z1WFPIUNBSZDJBGHRDCC6ZWK3TYFZ66PB4SVSSRQAA\";\r\n        next_keepalive = \"1970-01-01 00:00:00\";\r\n}\r\n\r\n\r\nupdate_state {\r\n        update_time = \"2023-10-04 16:13:36\";\r\n        last_version = \"252.07.29,92037\";\r\n        info_url = \"\";\r\n}\r\n\r\n\r\nmessages_from_manufacturer {\r\n        checked_time = \"2023-10-04 16:08:45\";\r\n        found = no;\r\n        check_intervall = 48;\r\n        present_message_ids = \"1-\";\r\n}\r\n\r\n\r\nletsencrypt {\r\n        enabled = no;\r\n        last_check = \"1970-01-01 00:00:00\";\r\n}\r\n\r\n\r\npcp {\r\n}\r\n\r\n\r\navmcountercfg {\r\n        rrddir = \"/var/tmp/rrd\";\r\n        rrdbackupdir = \"/var/media/ftp/FRITZ/rrd\";\r\n}\r\n\r\n\r\nboxmove_dest {\r\n        state = dest_state_none;\r\n        inetassi_after_import = no;\r\n        voipassi_after_import = no;\r\n        sid_ip = ::;\r\n}\r\n\r\n\r\n// EOF\r\n");

                        file.SetGroups(sec.GetList());

                        if(name != null) { 
                            this.files.Add(name, file);
                            observer?.Invoke(this, new FileEvent(file));
                        }
                    }
                }
            }
        }
    }
}
